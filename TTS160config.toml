title = "TTS160 Alpaca Driver"

[device]
dev_port = "COM5"

[site]
site_altitude = 0.0
site_latitude = 21.34722222222222
site_longitude = -157.90333333333334
site_elevation = 0.0

[driver]
sync_time_on_connect = true
slew_settle_time = 1
pulse_guide_equatorial_frame = true
pulse_guide_altitude_compensation = true
pulse_guide_max_compensation = 1000
pulse_guide_compensation_buffer = 20

[gps]
enabled = true
port = "auto"                    # "auto" to scan for GPS, or specific port like "COM3"
baudrate = 9600
min_fix_quality = 1              # NMEA GGA quality (1=GPS, 2=DGPS, 4=RTK)
min_satellites = 4
push_on_connect = true           # Push location once when mount connects (if fix valid)
location_name = "GPS"            # Max 10 chars, sent to mount
read_timeout = 2.0
verbose_logging = true

[alignment]
enabled = false
camera_source = "alpaca"         # Camera source: "alpaca" or "zwo"
camera_address = "127.0.0.1"     # Alpaca camera server address
camera_port = 11111              # Alpaca camera server port
camera_device = 0                # Camera device number
exposure_time = 1.0              # Exposure time in seconds
binning = 2                      # Camera binning (1, 2, or 4)
interval = 30.0                  # Interval between measurements (seconds)
fov_estimate = 1.0               # Estimated field of view (degrees)
detection_threshold = 5.0        # Star detection threshold (sigma)
max_stars = 50                   # Maximum stars for solving
error_threshold = 60.0           # Error warning threshold (arcseconds)
database_path = "tetra3_database.npz"
verbose_logging = false

# === V1 Decision Thresholds (arcseconds) ===
error_ignore = 30.0              # Below this, take no action
error_sync = 120.0               # Above this, sync if not aligning
error_concern = 300.0            # Above this, evaluate alignment replacement
error_max = 600.0                # Above this, force action and log health event

# === Geometry Thresholds (determinant, dimensionless 0-1) ===
det_excellent = 0.80             # Near-optimal; protect this geometry
det_good = 0.60                  # Solid; be selective about changes
det_marginal = 0.40              # Weak; actively seek improvement
det_improvement_min = 0.10       # Minimum improvement to justify replacement

# === Angular Constraints (degrees) ===
min_separation = 15.0            # Minimum angle between any two alignment points
refresh_radius = 10.0            # Distance within which "refresh" logic applies
scale_radius = 30.0              # Per-point weighted error distance falloff

# === Refresh Logic ===
refresh_error_threshold = 60.0   # Weighted error threshold for refresh eligibility (arcsec)

# === Lockout Periods (seconds) ===
lockout_post_align = 60.0        # After alignment point replacement
lockout_post_sync = 10.0         # After sync operation

# === Health Monitoring ===
health_window = 1800.0           # Window duration (seconds) - 30 minutes
health_alert_threshold = 5       # Events within window to trigger alert

# === ZWO Camera Settings ===
# Used when camera_source = "zwo"
[alignment.zwo]
camera_id = 0                    # Camera index (0 for first ZWO camera)
exposure_ms = 2000               # Exposure time in milliseconds
gain = 100                       # Camera gain (typically 0-500)
binning = 2                      # Pixel binning (1, 2, or 4)
image_type = "RAW16"             # Image format: RAW8, RAW16, RGB24, Y8
